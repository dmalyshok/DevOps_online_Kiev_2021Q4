## Task6.1
      1. Create virtual machines connection
```
Add Internal Network in VM1 and VM2 in virtualbox:

Internet - Host - enp0s3 (DHCP) - VM1 - enp0s8 (10.20.1.1) ----- Internal Network ---- enp0s3 (10.20.1.2)- VM 2
```
      2. VM2 has one interface (internal), VM1 has 2 interfaces (NAT and internal). Configure all network interfaces in order to make VM2 has an access to the Internet (iptables, forward, masquerade).
```
VM1:
ip addr
sudo vi /etc/netplan/00-installer-config.yaml


network:
  version: 2
  ethernets:
    enp0s3:
      dhcp4: true
    enp0s8:
            dhcp4: no
            addresses: [10.20.1.1/24]

malyshok@vm1malyshok:~$ netplan apply
malyshok@vm1malyshok:~$ ip add
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 08:00:27:e4:78:db brd ff:ff:ff:ff:ff:ff
    inet 10.0.2.15/24 brd 10.0.2.255 scope global dynamic enp0s3
       valid_lft 86162sec preferred_lft 86162sec
    inet6 fe80::a00:27ff:fee4:78db/64 scope link
       valid_lft forever preferred_lft forever
3: enp0s8: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 08:00:27:a6:d4:cb brd ff:ff:ff:ff:ff:ff
    inet 10.20.1.1/24 brd 10.20.1.255 scope global enp0s8
       valid_lft forever preferred_lft forever
    inet6 fe80::a00:27ff:fea6:d4cb/64 scope link
       valid_lft forever preferred_lft forever

root@vm1malyshok:~# ip route
default via 10.0.2.2 dev enp0s3 proto dhcp src 10.0.2.15 metric 100
10.0.2.0/24 dev enp0s3 proto kernel scope link src 10.0.2.15
10.0.2.2 dev enp0s3 proto dhcp scope link src 10.0.2.15 metric 100
10.20.1.0/24 dev enp0s8 proto kernel scope link src 10.20.1.1

 vi /etc/sysctl.conf
 sysctl -p

root@vm1malyshok:~# sysctl net.ipv4.ip_forward
net.ipv4.ip_forward = 1

iptables -t nat -A POSTROUTING -o enp0s3 -j MASQUERADE
apt install iptables-persistent
iptables-save
iptables-save > /etc/iptables/rules.v4

cat /etc/iptables/rules.v4
# Generated by iptables-save v1.8.4 on Thu Dec  9 18:01:00 2021
*nat
:PREROUTING ACCEPT [2:133]
:INPUT ACCEPT [1:72]
:OUTPUT ACCEPT [1:136]
:POSTROUTING ACCEPT [0:0]
-A POSTROUTING -o enp0s3 -j MASQUERADE
COMMIT
# Completed on Thu Dec  9 18:01:00 2021
# Generated by iptables-save v1.8.4 on Thu Dec  9 18:01:00 2021
*filter
:INPUT ACCEPT [79:5030]
:FORWARD ACCEPT [7:478]
:OUTPUT ACCEPT [74:10112]
COMMIT
# Completed on Thu Dec  9 18:01:00 2021


VM2:
malyshok@vm2malyshok:~$ ip add
sudo vi /etc/netplan/00-installer-config.yaml

malyshok@vm2malyshok:~$ cat /etc/netplan/00-installer-config.yaml
# This is the network config written by 'subiquity'
network:
  ethernets:
    enp0s3:
      dhcp4: no
      addresses: [10.20.1.2/24]
      gateway4: 10.20.1.1
      nameservers:
              addresses:
                      - 8.8.8.8
  version: 2

malyshok@vm2malyshok:~$ sudo netplan apply

malyshok@vm2malyshok:~$ ip addr
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 08:00:27:e4:78:db brd ff:ff:ff:ff:ff:ff
    inet 10.20.1.2/24 brd 10.20.1.255 scope global enp0s3
       valid_lft forever preferred_lft forever
    inet6 fe80::a00:27ff:fee4:78db/64 scope link
       valid_lft forever preferred_lft forever


malyshok@vm2malyshok:~$ ip route
default via 10.20.1.1 dev enp0s3 proto static
10.20.1.0/24 dev enp0s3 proto kernel scope link src 10.20.1.2

malyshok@vm2malyshok:~$ ping 10.20.1.1
PING 10.20.1.1 (10.20.1.1) 56(84) bytes of data.
64 bytes from 10.20.1.1: icmp_seq=1 ttl=64 time=0.611 ms
64 bytes from 10.20.1.1: icmp_seq=2 ttl=64 time=1.29 ms
64 bytes from 10.20.1.1: icmp_seq=3 ttl=64 time=1.36 ms
```
      3. Check the route from VM2 to Host.
```
malyshok@vm2malyshok:~$ ip route
default via 10.20.1.1 dev enp0s3 proto static
10.20.1.0/24 dev enp0s3 proto kernel scope link src 10.20.1.2

malyshok@vm2malyshok:~$ ping 10.20.1.1
PING 10.20.1.1 (10.20.1.1) 56(84) bytes of data.
64 bytes from 10.20.1.1: icmp_seq=1 ttl=64 time=0.611 ms
64 bytes from 10.20.1.1: icmp_seq=2 ttl=64 time=1.29 ms
64 bytes from 10.20.1.1: icmp_seq=3 ttl=64 time=1.36 ms
```
      4. Check the access to the Internet, (just ping, for example, 8.8.8.8).
```
malyshok@vm2malyshok:~$ ping 8.8.8.8
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=115 time=35.1 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=115 time=35.5 ms
```
      5. Determine, which resource has an IP address 8.8.8.8.
```
malyshok@vm2malyshok:~$ nslookup 8.8.8.8
8.8.8.8.in-addr.arpa    name = dns.google.

Authoritative answers can be found from:

malyshok@vm2malyshok:~$ host 8.8.8.8
8.8.8.8.in-addr.arpa domain name pointer dns.google.
```
      6. Determine, which IP address belongs to resource epam.com.
```
malyshok@vm2malyshok:~$ nslookup epam.com
Server:         127.0.0.53
Address:        127.0.0.53#53

Non-authoritative answer:
Name:   epam.com
Address: 3.214.134.159
```
      7. Determine the default gateway for your HOST and display routing table.
```
route print

IPv4 Route Table
===========================================================================
Active Routes:
Network Destination        Netmask          Gateway       Interface  Metric
          0.0.0.0          0.0.0.0     192.168.88.1   192.168.88.243     40
          8.8.8.8  255.255.255.255     192.168.88.1   192.168.88.243     41
```
      8. Trace the route to google.com.
```
malyshok@vm3malyshok:~$ tracepath -4 -n google.com
 1?: [LOCALHOST]                      pmtu 1500
 1:  10.20.1.1                                             0.185ms
 1:  10.20.1.1                                             0.149ms
 2:  10.0.2.2                                              0.250ms
 3:  no reply
```